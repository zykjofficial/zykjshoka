<!-- build time:Sun Sep 27 2020 20:13:28 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/favicon.ico"><link rel="mask-icon" href="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/logo.svg" color=""><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="卓越科技-" href="https://shoka.zykjofficial.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="卓越科技-" href="https://shoka.zykjofficial.top/atom.xml"><link rel="alternate" type="application/json" title="卓越科技-" href="https://shoka.zykjofficial.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/css/app.css?v=0.1.8"><meta name="keywords" content="AJAX"><meta name="description" content="Ajax是指一种创建交互式、快速动态网页应用的网页开发技术，无需重新加载整个网页的情况下，能够更新部分网页的技术。"><link rel="canonical" href="https://shoka.zykjofficial.top/posts/c747b178/"><title>AJAX 学习 - Web 教程 | 卓越科技的学习站 = 卓越科技 - = 卓越人生、只为科技。</title><meta name="generator" content="Hexo 5.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">AJAX 学习</h1><div class="meta"><span class="item" title="创建时间：2020-07-04 21:16:11"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-07-04T21:16:11+08:00">2020-07-04</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>8k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>7 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">卓越科技的学习站</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://cdn.jsdelivr.net/gh/zykjofficial/zykjimg/img/ajaxstudy-cover.png"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main id="main"><div class="inner"><div id="content" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/webCourse/" itemprop="item" rel="index" title="分类于 Web 教程"><span itemprop="name">Web 教程</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://shoka.zykjofficial.top/posts/c747b178/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/avatar.jpg"><meta itemprop="name" content="卓越科技-"><meta itemprop="description" content="卓越人生、只为科技。, Remarkable life,for science and technology."></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="卓越科技 -"></span><div class="body md" itemprop="articleBody"><div class="note danger"><p>本教程里的资料来源于网友的资料，自己整理以供学习。</p></div><h2 id="ajax学习"><a class="卓越科技-" href="#ajax学习">#</a> AJAX 学习</h2><h3 id="ajaxasynchronous-javascript-and-xml"><a class="卓越科技-" href="#ajaxasynchronous-javascript-and-xml">#</a> Ajax(asynchronous javascript and xml)</h3><div class="note danger"><p>Ajax描述了一种主要使用脚本操纵HTTP的Web应用架构，主要特点是使用脚本操纵HTTP和Web服务器进行数据交换，不会导致页面重载</p></div><h4 id="http协议"><a class="卓越科技-" href="#http协议">#</a> HTTP 协议</h4><p>HTTP 协议 (HyperText Transfer Protocal): 规定 Web 浏览器如何从 Web 服务器获取文档和向 Web 服务器提交表单内容，以及 Web 服务器如何响应这些请求和提交</p><p>分为 <code>请求报文</code> 和 <code>响应报文</code></p><p>请求报文包括:</p><ol><li><p>请求行</p><ul><li>HTTP 请求的方法 (GET 或 POST)</li><li>正在请求的 URL</li></ul></li><li><p>请求头 (可选，包含身份验证信息等)</p></li><li><p>请求主体 (可选，GET 方式没有请求主体)</p></li></ol><p>响应报文包括:</p><ol><li><p>状态行 (由文字和数字组成的状态码，用来显示请求的成功和失败。常见的有 200 OK、404 NOT FOUND、304 MODIFIED)</p></li><li><p>响应头集合</p></li><li><p>响应主体</p></li></ol><h4 id="xmlhttprequest的使用"><a class="卓越科技-" href="#xmlhttprequest的使用">#</a> XMLHttpRequest 的使用</h4><blockquote><p>浏览器在 XMLHttpRequest 类上定义了他们的 HTTP API。这个类的每个实例都表示一个独立的请求 / 响应对，并且这个对象的属性和方法允许指定请求细节和提取响应数据</p></blockquote><h5 id="使用基本步骤"><a class="卓越科技-" href="#使用基本步骤">#</a> 使用基本步骤</h5><p><code>GET方式</code> (适用于 URL 完全指定请求资源且请求对服务器没有任何服务器作用以及服务器的响应是可缓存时):</p><ol><li><p>实例化 XMLHttpRequest 对象</p><p><code>var 变量名 = new XMLHttpRequest()</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>设置请求行 (设置请求方式和请求 url，如果有数据则以 <code>?key=value</code> 形式添加在 URL 后面)</p><p><code>XHR对象.open('GET'，请求URL)</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span><span class="token string">'xxx.html?name=bruce'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>设置请求头 (GET 方式一般不用写)</p><p><code>XHR对象.setRequestHeader(键名，键值)</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'heima'</span><span class="token punctuation">,</span><span class="token string">'hehe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>向服务器发送 (GET 方式没有请求主题)</p><p><code>XHR对象.send(null或者省略)</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><p><code>POST方式</code> (在请求主体中常包含额外数据且这些数据常存储到服务器上的数据库中):</p><ol><li><p>实例化 XMLHttpRequest 对象</p><p><code>var 变量名 = new XMLHttpRequest()</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>设置请求行 (设置请求方式和请求 url)</p><p><code>XHR对象.open(提交方式，请求URL)</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span><span class="token string">'xxx.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>设置请求头 (POST 一定要写下面的请求头)</p><p><code>XHR对象.setRequestHeader(键名，键值)</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span><span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>该请求头的作用是让数据仿效表单提交</p></li><li><p>向服务器发送 (post 一般有发送主体，数据作为 send 函数参数发送)</p><p><code>XHR对象.send('key1=value&amp;key2=value')</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'name=jl&amp;friend=avgs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><p>注意:</p><ol><li><p>open 中的 url 参数必须是相对于当前文档的 url，否则跨域会报错，除非服务器明确允许跨域请求</p></li><li><p>HTTP 请求各部分有指定顺序：请求方法和 url 首先到达，然后是请求头，然后是请求主体，调用 XMLHttpRequest 的方法必须匹配 HTTP 请求的架构，比如 setRequestHeader 必须在 open 后 send 前</p></li><li><p>open 可以设置第三个参数为 false (默认为 true) 实现同步处理 HTTP 响应</p></li></ol><h5 id="服务器接收响应"><a class="卓越科技-" href="#服务器接收响应">#</a> 服务器接收响应</h5><p><code>不同服务器的代码不同、自行百度</code></p><p>注意:</p><ol><li><p>使用该对象必须在服务器中测试，即对 url 的访问必须经过服务器。XMLHttpRequest 用于同 http 和 https 协议一起工作，</p></li><li><p>发送请求等待服务器响应时是不阻塞的</p></li><li><p>服务器的正确解码是假设服务器为这个响应发送了 &quot;Content-Type&quot; 头和正确的 MIME 类型用以告诉浏览器数据应解析为的类型。如下表</p></li></ol><table><thead><tr><th>响应数据格式</th><th>应声明的头部</th></tr></thead><tbody><tr><td><code>text</code></td><td><code>header(Content-type: text/plain；charset=utf-8)</code> 可不写</td></tr><tr><td><code>XML</code></td><td><code>header(Content-type: text/xml；charset=utf-8)</code> 必写</td></tr><tr><td><code>json</code></td><td><code>header(Content-type: appliation/json；charset=utf-8)</code> 可不写</td></tr><tr><td><code>html</code></td><td><code>header(Content-type:text/html;charset=utf-8)</code></td></tr></tbody></table><h5 id="客户端获取响应数据一般用在xhr对象异步处理程序内"><a class="卓越科技-" href="#客户端获取响应数据一般用在xhr对象异步处理程序内">#</a> 客户端获取响应数据 (一般用在 XHR 对象异步处理程序内)</h5><ul><li><p>字符串形式数据</p><p><code>responseText可以得到响应主体的文本形式</code></p></li><li><p>XML 形式数据 (少用，了解即可)</p><p><code>responseXML获得Document形式，可以利用选择器获取其中元素的内容</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> name <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseXML<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>JSON 形式数据 (就是将对象等复杂数组用字符串作为载体传递 其中的所有要解析的键名键值都要用引号包裹 **，除非键值是数字，最常用的数据格式)</p></li></ul><p><code>JSON的特点:</code></p><ol><li><p>JSON 是一种数据的格式</p></li><li><p>JSON 和编程语言没有关系，其载体是字符串，基本上所有的语言都支持字符串</p></li><li><p>语法简洁 所有的编程语言都提供了对应的方法解析 JSON</p></li></ol><p><code>JSON语法</code></p><ul><li><p>JSON 数据格式</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"bruce"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">"age"</span><span class="token operator">:</span><span class="token string">"28"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token property">"skill"</span><span class="token operator">:</span><span class="token string">"detective"</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>注意：键名键值都要用双引号包裹，整个值用单引号包裹</p></li><li><p>JSON 的转换</p><p><code>JSON.parse(字符串)</code> : 将 json 数据转为对应对象或数组形式</p><p><code>JSON.stringify(数组或对象)</code> : 将对象或数组数据转为 json 格式</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> JSONArr <span class="token operator">=</span> <span class="token string">'["绿菜花","圣女果","大葱","番茄"]'</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="2"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>JSONArr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 圣女果 </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> JSONArr <span class="token operator">=</span> <span class="token string">'&#123;"name":"bruce","skill":"kill","friend":["alfred","clark","diana"]&#125;'</span><span class="token punctuation">;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>JSONArr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出字符串 </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>JSONArr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>friend<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//clark</span></pre></td></tr></table></figure></li><li><p>JSON 用法</p><ol><li><p>浏览器发出 ajax 请求</p></li><li><p>服务器端获取 ajax 数据 (可以读取 json 文件也可以直接写)</p><p><code>不同服务器的代码不同、自行百度</code></p><p>注意：发送 json 数据的 header 可写可不写，一般还是写</p></li><li><p>浏览器接收数据，转化，渲染</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token operator">&amp;&amp;</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="3"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 转化为对应的数据格式 </span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="5"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="7"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'姓名:'</span><span class="token operator">+</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'技能:'</span> <span class="token operator">+</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"skill"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ol></li></ul><h5 id="客户端异步处理http响应"><a class="卓越科技-" href="#客户端异步处理http响应">#</a> 客户端异步处理 HTTP 响应</h5><ol><li><p>用 onload 函数，当服务器成功接收到文件时，触发 load 事件，调用其中回调函数</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 			</pre></td></tr><tr><td data-num="2"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//responseText 获取响应报文 			</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span> 		</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p>使用 onreadystatechange 函数，当 XHR 对象的 readyState 属性发生变化时就会触发并调用其中回调函数</p><p>readyState 属性返回一个 XHR 对象当前所处的状态，其值主要有:</p><table><thead><tr><th>值</th><th>状态</th><th>描述</th></tr></thead><tbody><tr><td>0</td><td><code>UNSENT</code></td><td>代理被创建，但尚未调用 open () 方法</td></tr><tr><td>1</td><td><code>OPENED</code></td><td><code>open()</code> 方法已经被调用</td></tr><tr><td>2</td><td><code>HEADER_RECEIVED</code></td><td><code>send()</code> 方法已经被调用，并且头部和状态已经可获得</td></tr><tr><td>3</td><td><code>LOADING</code></td><td>下载中； <code>responseText</code> 属性已经包含部分数据</td></tr><tr><td>4</td><td><code>DONE</code></td><td>下载操作已完成</td></tr></tbody></table><p>一般可以和 status 属性配合使用检测 XHR 对象是否接受到数据。</p><p>statue 属性返回 XHR 对象的响应状态吗。成功一般为 200，找不到上传 url 会返回 404</p><p><code>可以利用以下代码完成更健壮的响应检测</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 	</pre></td></tr><tr><td data-num="3"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我触发一次'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#125;</span>	</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ol><h5 id="判断响应数据类型"><a class="卓越科技-" href="#判断响应数据类型">#</a> 判断响应数据类型</h5><p>可以利用 xhr 对象的 <code>getResponseHeader(获取内容)</code> 方法来获取响应头的内容</p><p>检验是否是 json</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token regex">/json/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>检验是否是 xml</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token regex">/xml/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="jquery中的ajax"><a class="卓越科技-" href="#jquery中的ajax">#</a> jQuery 中的 Ajax</h3><h4 id="jquery的get快捷函数"><a class="卓越科技-" href="#jquery的get快捷函数">#</a> jquery 的 get 快捷函数</h4><p><code>jQuery.get( url [, data ] [, success ] [, dataType ] )</code></p><p>参数亦可以写成对象形式 <code>jQuery.get(&#123;url:&quot;xxx.html&quot;,data:&quot;key=value&quot;,success:function(x)&#123;alert(x)&#125;&#125;)</code></p><p>参数信息:</p><ul><li><p><code>url</code> : 提交地址</p></li><li><p><code>data:</code> 提交数据，格式可以为键值对字符串也可以是对象形式</p></li><li><p><code>success</code> : 接收到数据后的回调函数，其中的第一个参数就是接收到的数据</p></li><li><p><code>dataType</code> : 从服务器返回的预期的数据类型</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"data.html"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">"bruce"</span><span class="token punctuation">,</span>husband<span class="token operator">:</span><span class="token string">"diana"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">alert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"data.html"</span><span class="token punctuation">,</span><span class="token string">"name=rose&amp;husband=jack"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">alert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ul><h4 id="jquery的post快捷函数"><a class="卓越科技-" href="#jquery的post快捷函数">#</a> jquery 的 post 快捷函数</h4><p><code>jQuery.post( url [, data ] [, success ] [, dataType ] )</code> 同样的，参数也可以写成对象形式</p><p>参数信息:</p><ul><li><p><code>url</code> : 提交地址</p></li><li><p><code>data</code> : 提交数据，格式可以为键值对字符串也可以是对象形式</p></li><li><p><code>success</code> : 接收到数据后的回调函数，其中的第一个参数就是接收到的数据</p></li><li><p><code>dataType</code> : 从服务器返回的预期的数据类型</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>$<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"data.html"</span><span class="token punctuation">,</span><span class="token string">"name=bruce"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">alert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ul><h4 id="jquery的ajax函数可以自己选择post还是get"><a class="卓越科技-" href="#jquery的ajax函数可以自己选择post还是get">#</a> jQuery 的 ajax 函数 (可以自己选择 post 还是 get)</h4><p>参数必须以对象形式写</p><p><code>jQuery.ajax(&#123;url:&quot;xxx.html&quot;,type:&quot;get&quot;,data:&quot;name=bruce&quot;,success:function(x)&#123;console.log(x)&#125;&#125;)</code></p><p>参数信息:</p><ul><li><p><code>url</code> : 提交地址</p></li><li><p><code>type</code> : 提交方式</p></li><li><p><code>data</code> : 提交数据，格式可以为键值对字符串也可以是对象形式</p></li><li><p><code>beforesend</code> :ajax 请求发出前执行的函数</p></li><li><p><code>success</code> : 接收到数据后的回调函数，其中的第一个参数就是接收到的数据，，第二个参数是 jQuery 状态码，第三个是 XHR 对象</p></li><li><p><code>error</code> : 当响应发生错误时触发，可以接受三个参数，依次代表发起请求的 xhr 对象，jQuery 状态码，发生错误的位置</p></li><li><p><code>complete</code> : 请求完全完成时触发</p></li><li><p><code>dataType</code> : 可以自己声明接收的数据类型而不需要后台声明，包括 json、xml 等</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> 		</pre></td></tr><tr><td data-num="2"></td><td><pre>    url<span class="token operator">:</span><span class="token string">'json.php'</span><span class="token punctuation">,</span> 		</pre></td></tr><tr><td data-num="3"></td><td><pre>    data<span class="token operator">:</span><span class="token punctuation">&#123;</span> 			</pre></td></tr><tr><td data-num="4"></td><td><pre>        name<span class="token operator">:</span><span class="token string">"bruce"</span><span class="token punctuation">,</span> 		</pre></td></tr><tr><td data-num="5"></td><td><pre>        skill<span class="token operator">:</span><span class="token string">"kill"</span> 	</pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 	</pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 	</pre></td></tr><tr><td data-num="8"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 		</pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 		</pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">//error 属性在请求失败时会触发 		</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">XMLHttpRequest<span class="token punctuation">,</span>textStatus<span class="token punctuation">,</span>errorThrown</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 		</pre></td></tr><tr><td data-num="12"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 			</pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token comment">//xhr 对象信息 		</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>XMLHttpRequest<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">// 错误类型 			</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>textStatus<span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">// 错误位置 		</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>errorThrown<span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> 		</pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token comment">// 请求完成时触发 (readyStatus == 4 时触发) 		</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function-variable function">complete</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 		</pre></td></tr><tr><td data-num="22"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li></ul><h4 id="jquery的其他ajax相关函数"><a class="卓越科技-" href="#jquery的其他ajax相关函数">#</a> jQuery 的其他 ajax 相关函数</h4><p><code>$(document).ajaxStart(function()&#123;&#125;)</code></p><p>document 中的任意 ajax 事件触发时便会触发这个事件中，调用其中回调函数， <code>必须绑定在document上</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ajaxStart</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 		</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".cover"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>$(document).ajaxComplete(function()&#123;&#125;)</code></p><p>document 中的任意 ajax 事件刚完成时便会触发这个事件，调用其中回调函数， <code>必须绑定在document上</code></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ajaxComplete</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 		</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".cover"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>附: jQuery 的 Ajax 状态码</p><table><thead><tr><th>success</th><th>请求成功完成</th></tr></thead><tbody><tr><td><code>notmodified</code></td><td>请求以正常完成，但是 url 内容与上次相同</td></tr><tr><td><code>error</code></td><td>请求没有完成，发生某些 http 错误</td></tr><tr><td><code>timeout</code></td><td>没有在规定时间内完成</td></tr><tr><td><code>parsererror</code></td><td>请求完成，但无法正常解析数据，比如服务器中的数据格式错误</td></tr></tbody></table><h3 id="模板和模板引擎的使用"><a class="卓越科技-" href="#模板和模板引擎的使用">#</a> 模板和模板引擎的使用</h3><p>百度吧</p><h3 id="跨域解决方案"><a class="卓越科技-" href="#跨域解决方案">#</a> 跨域解决方案</h3><ul><li><p><code>同源</code> ：协议、主机、端口都一样就是同源</p></li><li><p><code>不同源</code> ：协议主机端口有一个不一样就是不同源</p></li><li><p><code>跨域</code> ：不同源的网站之间发送请求就是跨域</p></li></ul><h4 id="两种跨域解决方案"><a class="卓越科技-" href="#两种跨域解决方案">#</a> 两种跨域解决方案</h4><ol><li><p>利用 CORS (Cross-Origin Resource Share):</p><p>在后台数据文件中添加头 <code>header(&quot;Acess-Control-Allow-origin:\*&quot;);</code></p><p>实现条件:</p><ul><li>浏览器支持 CORS</li><li>请求的网站开启 CROS</li></ul><p>缺点: HTML5 才支持</p></li><li><p>利用 JSONP (JSON with Padding)</p><p>只需设置 script 标签的 src 属性</p><p>原理：利用标签 src 属性可以获取跨域资源的原理，在 src 中将函数方法等数据传给服务器，服务器中再采用 JSON 的格式输出，浏览器获得该数据后会自动按照 JS 语法解析，实现对数据的处理</p><p>优点:</p><ul><li>不受同源策略限制</li><li>会自动解码执行包含 JSON 编码数据的响应体</li></ul><p>注意:</p><ol><li><p>src 属性充当了 Ajax，JSONP 与 Ajax 无关，JSONP 只需要一个 src 属性指向请求地址的 script 标签</p></li><li><p>回调函数一般统一叫 callback</p></li><li><p>JSONP 只能发送 get 请求，不能发送 post 请求</p></li><li><p>jQuery 中的 JSONP 的原理是动态创建了 script 标签，其中 src 等于请求地址 +&quot;？&quot;+success 方法</p></li><li><p>img 不用于 JSONP 的原因是 img 的 src 属性能发送数据，但是服务器的响应一直是一张图片导致客户端无法轻易从中提取信息</p></li><li><p>iframe 不用于 JSONP 的原因是其受限于同源策略</p></li><li><p>对于不可信任的服务器，不该使用这项技术</p></li><li><p>响应内容必须用 JS 函数名和圆括号包裹起来</p></li></ol></li><li><p>利用跨域消息传递 (window 对象的 postMessage 方法，HTML5 新增)</p><p>window 对象的 postMessage 方法允许来自非同源的脚本调用，允许有限的通信，通过异步传递的方法。这项技术称为 &quot;跨文档消息传递&quot;</p><p>步骤 (以 open 打开新窗口为例):</p><ol><li><p>弹出一个用于发送信息的窗口</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> w <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://192.168.43.112/anotherWayCrossOrigin/receiver.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>在弹出的窗口中，打开这个页面的页面向自己传递数据，达到跨域的效果</p><p><code>Window.postMessage(data,url)</code></p><p><code>data</code> : 任意基本类型或者可以复制的对象，如果想要传递数组或对象可以用 JSON 数据</p><p><code>url</code> : 指定目标窗口的源 (注意是源而不是某个文件，包括协议主机名和端口，除了这些以外的其他参数会被忽略)，会传给指定 url 下的任何页</p><p>如果设置为 <code>*</code> ，则可以传递给任何窗口。如果设定为 /，则只能传给与当前页面同源的文件</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'ha'</span><span class="token punctuation">,</span><span class="token string">'hey'</span><span class="token punctuation">,</span><span class="token string">'he'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>opener<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"http://127.0.0.1//anotherWayCrossOrigin/index.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p>在最初页面中，Window 对象调用 message 事件异步处理接收到的信息</p><p>可以利用该事件的事件对象的属性获取数据，其中包括:</p><ul><li><code>e.data</code> 接收到的数据</li><li><code>e.source</code> 数据源自的 Window 对象</li><li><code>e.origin</code> 一个字符串，指定消息来源 (URL 格式)</li></ul><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>window<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="2"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ["ha", "hey", "he"] </span></pre></td></tr><tr><td data-num="3"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Window 对象</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//http://192.168.43.112</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ol></li></ol><p><code>原理总结: 让接收信息的页面跑到发送信息的页面向自己发送信息 发送信息的页面必须是接收信息的页面打开的</code></p><p>跨域消息传递可用于解决以下方面的问题:</p><ul><li>iframe 嵌套页面跨域通信</li><li>页面和其打开的新窗口的通信</li><li>多窗口之间消息传递</li></ul><h3 id="xmlhttprequest20"><a class="卓越科技-" href="#xmlhttprequest20">#</a> XMLHttpRequest2.0</h3><h4 id="1快速格式化表单数据"><a class="卓越科技-" href="#1快速格式化表单数据">#</a> 1. 快速格式化表单数据</h4><p>利用 FormData 对象快速格式化 form 表单元素，然后作为发送主体传送</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> sendData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"form"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>sendData<span class="token punctuation">)</span>；</pre></td></tr></table></figure><h4 id="2ajax上传文件"><a class="卓越科技-" href="#2ajax上传文件">#</a> 2.ajax 上传文件</h4><p>在上面方法基础上在 form 中添加 file 表单即可</p><h4 id="3上传进度监控兼容性一般"><a class="卓越科技-" href="#3上传进度监控兼容性一般">#</a> 3. 上传进度监控 (兼容性一般)</h4><p>利用 xhr 对象 upload 属性的 progress 事件的事件对象监听上传进度</p><p><code>upload</code> : 代表上传过程</p><p><code>e.loaded</code> : 已经上传的数据大小</p><p><code>e.total</code> : 传输完成的数据大小</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>xhr<span class="token punctuation">.</span>upload<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 	</pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">// console.log(e); 		</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>loaded <span class="token operator">/</span> e<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="4"></td><td><pre>    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".step"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>loaded <span class="token operator">/</span> e<span class="token punctuation">.</span>total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span> 	</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag"><i class="ic i-tag"></i> 前端</a> <a href="/tags/AJAX/" rel="tag"><i class="ic i-tag"></i> AJAX</a></div></div><footer><div class="meta"></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/wechatpay.png" alt="卓越科技- 微信支付"><p>微信支付</p></div><div><img data-src="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/alipay.png" alt="卓越科技- 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>卓越科技- <i class="ic i-at"><em>@</em></i>卓越科技 -</li><li class="link"><strong>本文链接：</strong> <a href="https://shoka.zykjofficial.top/posts/c747b178/" title="AJAX 学习">https://shoka.zykjofficial.top/posts/c747b178/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="nav"><div class="item left"><a href="/posts/7a95906a/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;zykjofficial&#x2F;zykjimg&#x2F;img&#x2F;jquerystudy-cover.png" title="jQuery学习"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Web 教程</span><h3>jQuery学习</h3></a></div><div class="item right"><a href="/posts/d8fc8ff1/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;zykjofficial&#x2F;zykjimg&#x2F;img&#x2F;nodejsstudy-cover.png" title="Nodejs学习"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Web 教程</span><h3>Nodejs学习</h3></a></div></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.</span> <span class="toc-text">AJAX 学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ajaxasynchronous-javascript-and-xml"><span class="toc-number">1.1.</span> <span class="toc-text">Ajax(asynchronous javascript and xml)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">HTTP 协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xmlhttprequest%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.2.</span> <span class="toc-text">XMLHttpRequest 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">使用基本步骤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E6%94%B6%E5%93%8D%E5%BA%94"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">服务器接收响应</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E6%95%B0%E6%8D%AE%E4%B8%80%E8%88%AC%E7%94%A8%E5%9C%A8xhr%E5%AF%B9%E8%B1%A1%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E5%86%85"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">客户端获取响应数据 (一般用在 XHR 对象异步处理程序内)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86http%E5%93%8D%E5%BA%94"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">客户端异步处理 HTTP 响应</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%93%8D%E5%BA%94%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">判断响应数据类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jquery%E4%B8%AD%E7%9A%84ajax"><span class="toc-number">1.2.</span> <span class="toc-text">jQuery 中的 Ajax</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jquery%E7%9A%84get%E5%BF%AB%E6%8D%B7%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">jquery 的 get 快捷函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jquery%E7%9A%84post%E5%BF%AB%E6%8D%B7%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">jquery 的 post 快捷函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jquery%E7%9A%84ajax%E5%87%BD%E6%95%B0%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%B7%B1%E9%80%89%E6%8B%A9post%E8%BF%98%E6%98%AFget"><span class="toc-number">1.2.3.</span> <span class="toc-text">jQuery 的 ajax 函数 (可以自己选择 post 还是 get)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jquery%E7%9A%84%E5%85%B6%E4%BB%96ajax%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.4.</span> <span class="toc-text">jQuery 的其他 ajax 相关函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%92%8C%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">模板和模板引擎的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.4.</span> <span class="toc-text">跨域解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.4.1.</span> <span class="toc-text">两种跨域解决方案</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xmlhttprequest20"><span class="toc-number">1.5.</span> <span class="toc-text">XMLHttpRequest2.0</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%BF%AB%E9%80%9F%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.1.</span> <span class="toc-text">1. 快速格式化表单数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2ajax%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="toc-number">1.5.2.</span> <span class="toc-text">2.ajax 上传文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E4%B8%8A%E4%BC%A0%E8%BF%9B%E5%BA%A6%E7%9B%91%E6%8E%A7%E5%85%BC%E5%AE%B9%E6%80%A7%E4%B8%80%E8%88%AC"><span class="toc-number">1.5.3.</span> <span class="toc-text">3. 上传进度监控 (兼容性一般)</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/posts/c747b178/" rel="bookmark" title="AJAX学习">AJAX学习</a></li><li><a href="/posts/5650a45b/" rel="bookmark" title="Axios学习">Axios学习</a></li><li><a href="/posts/238675c9/" rel="bookmark" title="CSS学习">CSS学习</a></li><li><a href="/posts/9b6eaec3/" rel="bookmark" title="HTML学习">HTML学习</a></li><li><a href="/posts/d3a7443d/" rel="bookmark" title="JavaScript学习">JavaScript学习</a></li><li><a href="/posts/8cde864d/" rel="bookmark" title="JavaScript高级">JavaScript高级</a></li><li><a href="/posts/d8fc8ff1/" rel="bookmark" title="Nodejs学习">Nodejs学习</a></li><li><a href="/posts/7a95906a/" rel="bookmark" title="jQuery学习">jQuery学习</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="卓越科技-" data-src="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/images/avatar.jpg"><p class="name" itemprop="name">卓越科技-</p><div class="description" itemprop="description">Remarkable life,for science and technology.</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">9</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">2</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">11</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3p5a2pvZmZpY2lhbA==" title="https:&#x2F;&#x2F;github.com&#x2F;zykjofficial"><i class="ic i-github"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTQwMDc0NjM0NQ==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;400746345"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vNjU4ODI0NDM4NQ==" title="https:&#x2F;&#x2F;weibo.com&#x2F;6588244385"><i class="ic i-weibo"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnNoaWtvbmd4aWFvbXlzQGdtYWlsLmNvbQ==" title="mailto:shikongxiaomys@gmail.com"><i class="ic i-envelope"></i></span> <a href="/about/" title="&#x2F;about&#x2F;" class="item about"><i class="ic i-address-card"></i></a></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/link/" rel="section"><i class="ic i-heart"></i>友達</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/posts/7a95906a/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/posts/d8fc8ff1/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">卓越科技- @ 卓越科技的学习站</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">196k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:58</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"https://shoka.zykjofficial.top/posts/c747b178/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 ${query} ，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(t){return t.includes("#")},function(t){return t===LOCAL.path}]}</script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/velocity-animate@1.5.2/velocity.min.js,npm/velocity-animate@1.5.2/velocity.ui.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js,npm/leancloud-storage@3/dist/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/zykjofficial/zykjshoka@gh-pages/js/app.js?v=0.1.8"></script></body></html><!-- rebuild by hrmmi -->